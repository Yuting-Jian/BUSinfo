"use strict";(self["webpackChunkbus_pass"]=self["webpackChunkbus_pass"]||[]).push([[389],{2389:function(t,e,i){i.r(e),i.d(e,{default:function(){return r}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"bd-wrapper"},[e("div",{staticClass:"title"},[e("h2",[e("i",{directives:[{name:"show",rawName:"v-show",value:t.checkActive?t.go.length>1:t.back.length>1,expression:"checkActive? go.length>1:back.length>1"}],staticClass:"fa-solid fa-caret-left",on:{click:function(e){return t.changeNumber(-1)}}}),t._v(" "+t._s(t.title)+" "),e("i",{directives:[{name:"show",rawName:"v-show",value:t.checkActive?t.go.length>1:t.back.length>1,expression:"checkActive? go.length>1:back.length>1"}],staticClass:"fa-solid fa-caret-right",on:{click:function(e){return t.changeNumber(1)}}})]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.switchShow,expression:"switchShow"}],staticClass:"switch",class:{active:!t.checkActive},on:{click:t.toggle}},[e("div",{staticClass:"btn",class:{active:!t.checkActive}}),e("span",[t._v("去")]),e("span",[t._v("返")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:!(t.back.length>0),expression:"!(back.length > 0)"}],staticClass:"circle"},[e("p",[t._v("循環線")])])]),e("div",{staticClass:"bus-detail"},[e("ul",{staticClass:"stoplist"},t._l(t.busStopsList.Stops,(function(i,s){return e("li",{key:s},[e("div",[e("p",[t._v(t._s(i.StopName.Zh_tw))]),e("span",{class:{active:t.secToMin(i.EstimateTime)<4&&0==i.StopStatus}},[t._v(t._s(t.stopStatus(i.StopStatus,i.EstimateTime)))])])])})),0)])])},a=[],h=i(3822),o={name:"BusDetail",data(){return{checkActive:!0,go:[],back:[],gonumber:0,backnumber:0,timer:""}},computed:{busStopsList(){return this.checkActive?(this.go[this.gonumber]&&this.dataComparison(this.go[this.gonumber]),this.go[this.gonumber]||[]):(this.dataComparison(this.back[this.backnumber]),this.back[this.backnumber]||[])},switchShow(){let t;for(var e=0;e<this.back.length;e++)if(this.back[e].SubRouteUID==this.go[this.gonumber].SubRouteUID||this.back[e].SubRouteName.en==this.go[this.gonumber].SubRouteName.en){this.backnumber=e,t=this.back[e];break}return t},title(){return this.checkActive?this.go.length<1?"loading...":1==this.go.length?this.go[this.gonumber].RouteName.Zh_tw:this.go[this.gonumber].SubRouteName.Zh_tw:this.back.length<1?"loading...":1==this.back.length?this.back[this.backnumber].RouteName.Zh_tw:this.back[this.backnumber].SubRouteName.Zh_tw},...(0,h.rn)("busdetail",["busStopsData","estimatedTime"])},async mounted(){try{await this.$store.dispatch("busdetail/getbusEstimatedTime",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID}),await this.$store.dispatch("busdetail/getBusStopsData",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID}),this.splitData()}catch(t){console.log(t)}this.timer=setInterval((async()=>{try{await this.$store.dispatch("busdetail/getbusEstimatedTime",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID}),await this.$store.dispatch("busdetail/getBusStopsData",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID}),this.splitData()}catch(t){console.log(t)}}),6e4)},methods:{toggle(){if(!this.checkActive)for(let t;t<this.go.length;t++)if(this.go[t].SubRouteUID==this.back[this.backnumber].SubRouteUID||this.go[t].SubRouteName.en==this.back[this.backnumber].SubRouteName.en){this.gonumber=t;break}this.checkActive=!this.checkActive},splitData(){this.go=this.busStopsData.filter((t=>0==t.Direction&&-1==t.SubRouteName.Zh_tw.indexOf("停駛"))),this.back=this.busStopsData.filter((t=>1==t.Direction&&-1==t.SubRouteName.Zh_tw.indexOf("停駛")))},dataComparison(t){if(!t.Comparison){t.Comparison=!0;let e=t.Stops;if(this.estimatedTime[0].SubRouteUID){for(let i=0;i<this.estimatedTime.length;i++)if(this.estimatedTime[i].Direction==t.Direction&&this.estimatedTime[i].SubRouteUID==t.SubRouteUID)for(let t=0;t<e.length;t++)this.estimatedTime[i].StopSequence?this.estimatedTime[i].StopSequence==e[t].StopSequence&&(e[t].EstimateTime=this.estimatedTime[i].EstimateTime,e[t].StopStatus=this.estimatedTime[i].StopStatus):this.estimatedTime[i].StopUID==e[t].StopUID&&(e[t].EstimateTime=this.estimatedTime[i].EstimateTime,e[t].StopStatus=this.estimatedTime[i].StopStatus)}else for(let i=0;i<this.estimatedTime.length;i++)if(this.estimatedTime[i].Direction==t.Direction)for(let t=0;t<e.length;t++)this.estimatedTime[i].StopSequence?this.estimatedTime[i].StopSequence==e[t].StopSequence&&this.estimatedTime[i].StopUID==e[t].StopUID&&(e[t].EstimateTime=this.estimatedTime[i].EstimateTime,e[t].StopStatus=this.estimatedTime[i].StopStatus):this.estimatedTime[i].StopUID==e[t].StopUID&&(e[t].EstimateTime=this.estimatedTime[i].EstimateTime,e[t].StopStatus=this.estimatedTime[i].StopStatus)}},changeNumber(t){this.checkActive?(this.gonumber+=t,this.gonumber==this.go.length?this.gonumber=0:this.gonumber<0&&(this.gonumber=this.go.length-1)):(this.backnumber+=t,this.backnumber==this.back.length?this.backnumber=0:this.backnumber<0&&(this.backnumber=this.back.length-1))},stopStatus(t,e){switch(t){case 0:return""+(0==this.secToMin(e)?"即將抵達":"預計"+this.secToMin(e)+"min抵達");case 1:return"尚未發車";case 2:return"交管不停靠";case 3:return"末班車已過";case 4:return"今日未營運"}},secToMin(t){return Math.round(t/60)}},destroyed(){clearInterval(this.timer)}},c=o,u=i(1001),n=(0,u.Z)(c,s,a,!1,null,"bfa03ba2",null),r=n.exports}}]);
//# sourceMappingURL=389.5cc8be37.js.map