{"version":3,"file":"js/389.5cc8be37.js","mappings":"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","sources":["webpack://bus-pass/./src/page/BusRoute/BusDetail/index.vue","webpack://bus-pass/src/page/BusRoute/BusDetail/index.vue","webpack://bus-pass/./src/page/BusRoute/BusDetail/index.vue?3083","webpack://bus-pass/./src/page/BusRoute/BusDetail/index.vue?fb10"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"bd-wrapper\"},[_c('div',{staticClass:\"title\"},[_c('h2',[_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.checkActive? _vm.go.length>1:_vm.back.length>1),expression:\"checkActive? go.length>1:back.length>1\"}],staticClass:\"fa-solid fa-caret-left\",on:{\"click\":function($event){return _vm.changeNumber(-1)}}}),_vm._v(\" \"+_vm._s(_vm.title)+\" \"),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.checkActive? _vm.go.length>1:_vm.back.length>1),expression:\"checkActive? go.length>1:back.length>1\"}],staticClass:\"fa-solid fa-caret-right\",on:{\"click\":function($event){return _vm.changeNumber(1)}}})]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.switchShow),expression:\"switchShow\"}],staticClass:\"switch\",class:{active:!_vm.checkActive},on:{\"click\":_vm.toggle}},[_c('div',{staticClass:\"btn\",class:{active:!_vm.checkActive}}),_c('span',[_vm._v(\"去\")]),_c('span',[_vm._v(\"返\")])]),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!(_vm.back.length > 0)),expression:\"!(back.length > 0)\"}],staticClass:\"circle\"},[_c('p',[_vm._v(\"循環線\")])])]),_c('div',{staticClass:\"bus-detail\"},[_c('ul',{staticClass:\"stoplist\"},_vm._l((_vm.busStopsList.Stops),function(stop,index){return _c('li',{key:index},[_c('div',[_c('p',[_vm._v(_vm._s(stop.StopName.Zh_tw))]),_c('span',{class:{active: (_vm.secToMin(stop.EstimateTime) < 4) && stop.StopStatus == 0}},[_vm._v(_vm._s(_vm.stopStatus(stop.StopStatus,stop.EstimateTime)))])])])}),0)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"bd-wrapper\">\r\n    <div class=\"title\">\r\n        <h2>\r\n            <i class=\"fa-solid fa-caret-left\" @click=\"changeNumber(-1)\" v-show=\"checkActive? go.length>1:back.length>1\"></i>\r\n            {{title}}\r\n            <i class=\"fa-solid fa-caret-right\" @click=\"changeNumber(1)\" v-show=\"checkActive? go.length>1:back.length>1\"></i>\r\n        </h2>\r\n        <div class=\"switch\" :class=\"{active:!checkActive}\" @click=\"toggle\" v-show=\"switchShow\">\r\n            <div class=\"btn\" :class=\"{active:!checkActive}\" ></div>\r\n            <span>去</span>\r\n            <span>返</span>\r\n        </div>\r\n        <div class=\"circle\" v-show=\"!(back.length > 0)\">\r\n            <p>循環線</p>\r\n        </div>\r\n    </div>\r\n    <div class=\"bus-detail\">\r\n        <ul class=\"stoplist\" >\r\n            <li v-for=\"(stop,index) in busStopsList.Stops\" :key=\"index\">\r\n                <div>\r\n                    <p>{{stop.StopName.Zh_tw}}</p>\r\n                    <span :class=\"{active: (secToMin(stop.EstimateTime) < 4) && stop.StopStatus == 0}\">{{stopStatus(stop.StopStatus,stop.EstimateTime)}}</span>\r\n                </div>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from \"vuex\"\r\n\r\nexport default {\r\n    name:\"BusDetail\",\r\n    data() {\r\n        return {\r\n            checkActive:true,\r\n            go:[],\r\n            back:[],\r\n            gonumber:0,\r\n            backnumber:0,\r\n            timer:\"\",\r\n        }\r\n    },\r\n    computed:{\r\n        busStopsList(){\r\n            if(this.checkActive){\r\n                if(this.go[this.gonumber]){\r\n                    this.dataComparison(this.go[this.gonumber]);\r\n                }\r\n                return this.go[this.gonumber] || [];\r\n            }else{\r\n                this.dataComparison(this.back[this.backnumber]);\r\n                return this.back[this.backnumber] || [];\r\n            }\r\n        },\r\n        switchShow(){\r\n            let back = undefined;\r\n            for(var i=0;i<this.back.length;i++){\r\n                if(this.back[i].SubRouteUID == this.go[this.gonumber].SubRouteUID || this.back[i].SubRouteName.en == this.go[this.gonumber].SubRouteName.en){\r\n                    this.backnumber = i;\r\n                    back = this.back[i];\r\n                    break;\r\n                }\r\n            }\r\n            return back;\r\n        },\r\n        title(){\r\n            if(this.checkActive){\r\n                if(this.go.length < 1){\r\n                    return \"loading...\";\r\n                }else if(this.go.length == 1){\r\n                    return this.go[this.gonumber].RouteName.Zh_tw\r\n                }else{\r\n                    return this.go[this.gonumber].SubRouteName.Zh_tw\r\n                }\r\n            }else{\r\n                if(this.back.length < 1){\r\n                    return \"loading...\";\r\n                }else if(this.back.length == 1){\r\n                    return this.back[this.backnumber].RouteName.Zh_tw\r\n                }else{\r\n                    return this.back[this.backnumber].SubRouteName.Zh_tw\r\n                }\r\n            }\r\n            \r\n        },\r\n        ...mapState(\"busdetail\",[\"busStopsData\",\"estimatedTime\"]),\r\n    },\r\n    async mounted() {\r\n        try{\r\n            await this.$store.dispatch(\"busdetail/getbusEstimatedTime\",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID});\r\n            await this.$store.dispatch(\"busdetail/getBusStopsData\",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID});\r\n            this.splitData();\r\n        }catch(e){\r\n            console.log(e);\r\n        }\r\n        this.timer = setInterval(async ()=>{\r\n            try{\r\n                await this.$store.dispatch(\"busdetail/getbusEstimatedTime\",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID});\r\n                await this.$store.dispatch(\"busdetail/getBusStopsData\",{city:this.$route.query.city,RouteUID:this.$route.query.RouteUID});\r\n                this.splitData();\r\n            }catch(e){\r\n                console.log(e);\r\n            }\r\n        },60000);\r\n    },\r\n    methods:{\r\n        toggle(){\r\n            if(!this.checkActive){\r\n                for(let i ; i<this.go.length ; i++){\r\n                    if(this.go[i].SubRouteUID == this.back[this.backnumber].SubRouteUID || this.go[i].SubRouteName.en == this.back[this.backnumber].SubRouteName.en){\r\n                        this.gonumber = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            this.checkActive = !this.checkActive;\r\n        },\r\n        splitData(){\r\n            this.go = this.busStopsData.filter(item=>{\r\n                return item.Direction == 0 && (item.SubRouteName.Zh_tw.indexOf(\"停駛\") == -1);\r\n            });\r\n\r\n            this.back = this.busStopsData.filter(item=>{\r\n                return item.Direction == 1 && (item.SubRouteName.Zh_tw.indexOf(\"停駛\") == -1);\r\n            });\r\n        },\r\n        dataComparison(data){\r\n            if(!data.Comparison){\r\n\r\n                data.Comparison = true;\r\n                let Stops = data.Stops;\r\n                if(this.estimatedTime[0].SubRouteUID){\r\n                    for(let i=0;i<this.estimatedTime.length;i++){\r\n                        if(this.estimatedTime[i].Direction == data.Direction && (this.estimatedTime[i].SubRouteUID == data.SubRouteUID)){\r\n                            for(let j=0;j<Stops.length;j++){\r\n                                if(this.estimatedTime[i].StopSequence){\r\n                                    if(this.estimatedTime[i].StopSequence == Stops[j].StopSequence){\r\n                                        Stops[j].EstimateTime = this.estimatedTime[i].EstimateTime;\r\n                                        Stops[j].StopStatus = this.estimatedTime[i].StopStatus;\r\n                                    }\r\n                                }else{\r\n                                    if(this.estimatedTime[i].StopUID == Stops[j].StopUID){\r\n                                        Stops[j].EstimateTime = this.estimatedTime[i].EstimateTime;\r\n                                        Stops[j].StopStatus = this.estimatedTime[i].StopStatus;\r\n                                    }   \r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }else{\r\n                    for(let i=0;i<this.estimatedTime.length;i++){\r\n                        if(this.estimatedTime[i].Direction == data.Direction){\r\n                            for(let j=0;j<Stops.length;j++){\r\n                                if(this.estimatedTime[i].StopSequence){\r\n                                    if(this.estimatedTime[i].StopSequence == Stops[j].StopSequence && this.estimatedTime[i].StopUID == Stops[j].StopUID){\r\n                                        Stops[j].EstimateTime = this.estimatedTime[i].EstimateTime;\r\n                                        Stops[j].StopStatus = this.estimatedTime[i].StopStatus;\r\n                                    }\r\n                                }else{\r\n                                    if(this.estimatedTime[i].StopUID == Stops[j].StopUID){\r\n                                        Stops[j].EstimateTime = this.estimatedTime[i].EstimateTime;\r\n                                        Stops[j].StopStatus = this.estimatedTime[i].StopStatus;\r\n                                    }   \r\n                                }\r\n                            }\r\n                        }\r\n                    } \r\n                }\r\n            } \r\n        },\r\n        changeNumber(number){\r\n            if(this.checkActive){\r\n                this.gonumber += number;\r\n                if(this.gonumber == this.go.length){\r\n                    this.gonumber = 0;\r\n                }else if(this.gonumber < 0 ){\r\n                    this.gonumber = (this.go.length - 1);\r\n                }\r\n            }else{\r\n                this.backnumber += number;\r\n                if(this.backnumber == this.back.length){\r\n                    this.backnumber = 0;\r\n                }else if(this.backnumber < 0 ){\r\n                    this.backnumber = (this.back.length - 1);\r\n                }\r\n            }    \r\n        },\r\n        stopStatus(status,estimatedTime){\r\n            switch (status){\r\n                case 0:\r\n                    return `${this.secToMin(estimatedTime) == 0? \"即將抵達\":\"預計\"+this.secToMin(estimatedTime)+\"min抵達\"}`;\r\n                case 1:\r\n                    return `尚未發車`;\r\n                case 2:\r\n                    return `交管不停靠`;\r\n                case 3:\r\n                    return `末班車已過`;\r\n                case 4:\r\n                    return `今日未營運`;\r\n            }\r\n            \r\n        },\r\n        secToMin(estimatedTime){\r\n            return Math.round(estimatedTime/60);\r\n        }\r\n    },\r\n    destroyed(){\r\n        clearInterval(this.timer);\r\n    }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n .bd-wrapper{\r\n    height: calc(100% - 64px);\r\n\r\n    .title{\r\n            position: relative;\r\n\r\n            h2{\r\n                background-color: white;\r\n                font-size: 20px;\r\n                font-weight: 700;\r\n                line-height: 52px;\r\n                border-radius: 20px 20px 0 0;\r\n                text-align: center;\r\n                box-shadow: 0 0 10px 0 rgba(114, 114, 114, 0.5);\r\n                \r\n                i{\r\n                    display: inline-block;\r\n                    margin: 0 10px;\r\n                    font-size: 24px;\r\n                    color: rgb(119, 119, 119);\r\n                    cursor: pointer;\r\n\r\n                    &:hover{\r\n                        color: black;\r\n                    }\r\n                }\r\n            }\r\n\r\n            .switch{\r\n                width: 34px;\r\n                line-height: 22px;\r\n                padding: 0 5px;\r\n                border-radius: 30px;\r\n                position: absolute;\r\n                bottom: 8px;\r\n                right: 24px;\r\n                background-color: rgb(35, 156, 5);\r\n                color: white;\r\n                font-size: 14px;\r\n                font-weight: 900;\r\n                box-shadow: 0 3px 2px 1px inset rgba(0, 0, 0, 0.2);\r\n                display: flex;\r\n                justify-content: space-between;\r\n                cursor: pointer;\r\n\r\n                .btn{\r\n                    width: 22px;\r\n                    height: 22px;\r\n                    position: absolute;\r\n                    right: 0;\r\n                    border-radius: 50%;\r\n                    background-color: white;\r\n                    box-shadow: 0px 2px 3px 0px rgba(102, 102, 102, 0.8),0px 0px 0px 1px rgba(148, 148, 148, 0.8);\r\n                }\r\n\r\n                .active{\r\n                    left:0;\r\n                }\r\n            }\r\n\r\n            .circle{\r\n                p{\r\n                    position: absolute;\r\n                    bottom: 8px;\r\n                    right: 24px;\r\n                    font-weight: 800;\r\n                }\r\n            }\r\n\r\n            .active{\r\n                background-color: rgb(253, 31, 31);\r\n            }\r\n\r\n    }\r\n\r\n\r\n    .bus-detail{\r\n        height: calc(100% - 52px);\r\n        background-color: white;\r\n        border-radius: 0px 0px 20px 20px;\r\n        box-shadow: 0 0 10px 0 rgba(114, 114, 114, 0.5);\r\n        overflow: auto;\r\n        box-sizing: border-box;\r\n        padding: 0 12px 12px;\r\n\r\n        .stoplist{\r\n            padding: 0 12px;\r\n\r\n            li{\r\n                height: 48px;\r\n                padding: 6px 12px;\r\n                border-bottom: 1px solid rgb(192, 192, 192);\r\n                display: flex;\r\n                align-items: flex-end;\r\n\r\n                div{\r\n                    \r\n                    p{\r\n                        display: inline-block;\r\n                        margin-right: 24px;\r\n                        font-size: 20px;\r\n                        font-weight: 900;\r\n                    }\r\n\r\n                    span{\r\n                        display: inline-block;\r\n                        padding: 5px 10px;\r\n                        border-radius: 30px;\r\n                        font-size: 14px;\r\n                        font-weight: 700;\r\n                        background-color: #CCC;\r\n                    }\r\n\r\n                    .active{\r\n                        background-color: rgb(255, 208, 0);\r\n                        color: rgb(0, 0, 0);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n }\r\n</style>","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=bfa03ba2&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=bfa03ba2&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bfa03ba2\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","directives","name","rawName","value","checkActive","go","length","back","expression","on","$event","changeNumber","_v","_s","title","switchShow","class","active","toggle","_l","busStopsList","Stops","stop","index","key","StopName","Zh_tw","secToMin","EstimateTime","StopStatus","stopStatus","staticRenderFns","data","gonumber","backnumber","timer","computed","city","RouteUID","console","methods","splitData","dataComparison","destroyed","clearInterval","component"],"sourceRoot":""}